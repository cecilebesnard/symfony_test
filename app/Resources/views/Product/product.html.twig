{% extends "layout.html.twig" %}

{% block title %}Product{% endblock %}

{%  block stylesheet %}
{{ parent() }}
 <link rel="stylesheet" href="{{ asset('plugins/datatables/dataTables.bootstrap.css') }}">
{% endblock %}

{% block ariane %}
    <li class="active">Produits</li>

{% endblock %}
{% block content %}

{% set total = 0 %}

{% set prix = [] %}
            {% for product in products %}

                {% set total = total + product.prix %}

                {% set prix = prix|merge([product.prix]) %}


            {% endfor %}



{% set total = total / products|length %}

{% set lemoincher = min(prix) %}

    <!-- Main content -->
    <section class="content">


        <div class="box">

            <div class="box-header">

                <h3 class="box-title">Tous les produits</h3>
                <button type="button" class="btn btn-block btn-info btn-sm">Créer</button>
            </div>
            <!-- /.box-header -->
            <div class="box-body">
                <table id="example1" class="table table-bordered table-striped">
                            <thead>
                            <tr>
                                <th>Id</th>
                                <th>Title</th>
                                <th>Description</th>
                                <th>Date</th>
                                <th>Action</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for product in products %}
                            <tr>
                                <td>{{ product.id }} </td>

               {% if product.prix == lemoincher %}

                                <td><u>{{ product.title }}</u> </td>
                     {% else %}
                                <td>{{ product.title }}</td>
               {% endif %}
                                <td>{{ product.description }} </td>
                                <td>{{ product.date_created|date("d/m/Y") }} </td>
                                <td><div class="btn-group">
                                        <a href="{{ path("show_product",{id:product.id}) }}"><button type="button" class="btn btn-info">Voir</button></a>
                                        <a href="{{ path("show_product",{id:product.id}) }}"><button type="button" class="btn btn bg-maroon">Editer</button></a>
                                        <a href="{{ path("show_product",{id:product.id}) }}"><button type="button" class="btn btn-primary">Supprimer</button></a>
                                    </div></td>
                            </tr>
                            {% endfor %}

                        </table>
                    </div>
                    <!-- /.box-body -->
                </div>




            <p>La moyenne des prix est : {{ total }}</p>


            <p>le prix le moins cher est : {{ lemoincher  }}</p>


 <div class="box box-primary">
            <div class="box-header with-border">
              <h3 class="box-title">Area Chart</h3>

              <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                </button>
                <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
              </div>
            </div>
            <div class="box-body">
              <div class="chart">
                <canvas id="areaChart" style="height:250px"></canvas>
              </div>
            </div>

{% endblock %}

 {% block javascript %}
        {{ parent() }}

<script src="{{ asset('plugins/datatables/jquery.dataTables.min.js') }}"></script>
<script src="{{ asset('plugins/datatables/dataTables.bootstrap.min.js') }}"></script>

<script>
    $(function () {
      $("#example1").DataTable(
              {
                "language": {
                  "lengthMenu": "Montrer _MENU_ enregistrement par page",
                  "zeroRecords": "Nothing found - sorry",
                  "info": "Montrer page _PAGE_ à _PAGES_",
                  "infoEmpty": "Pas d'enregistrement pour cette recherche",
                  "infoFiltered": "(filtré à partir de  _MAX_ enregistrements)"
                }
              });
    });
  </script>
{% endblock %}